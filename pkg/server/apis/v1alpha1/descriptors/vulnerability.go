package descriptors

import (
	handler "github.com/caicloud/cyclone/pkg/server/handler/v1alpha1"
	httputil "github.com/caicloud/cyclone/pkg/util/http"
	"github.com/caicloud/nirvana/definition"
)

func init() {
	register(vulnerability...)
}

var vulnerability = []definition.Descriptor{
	{
		Path:        "/vulnerabilities",
		Description: "Vulnerability APIs",
		Definitions: []definition.Definition{
			{
				Method:   definition.Create,
				Function: handler.CreateVulnerability,
				Parameters: []definition.Parameter{
					{
						Source:      definition.Body,
						Description: "JSON body contains vulnerability",
					},
				},
				Results: definition.DataErrorResults("vulnerability"),
			},
		},
	},

	{
		Path:        "/vulnerabilities/{vulnerability}",
		Description: "Vulnerability APIs",
		Definitions: []definition.Definition{
			{
				Method:   definition.Get,
				Function: handler.ListVulnerability,
				Parameters: []definition.Parameter{
					{
						Source: definition.Path,
						Name:   "vulnerability",
					},
					{
						Source: definition.Auto,
						Name:   httputil.PaginationAutoParameter,
					},
				},
				Results: definition.DataErrorResults("vulnerability"),
			},
		},
	},
}
